<!DOCTYPE html>
<html lang="en">

<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <!-- Meta, title, CSS, favicons, etc. -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>XALT! | CSCS</title>

        <!-- Bootstrap core CSS -->

        <link href="css/bootstrap.min.css" rel="stylesheet">

        <link href="fonts/css/font-awesome.min.css" rel="stylesheet">
        <link href="css/animate.min.css" rel="stylesheet">

        <!-- Custom styling plus plugins -->
        <link href="css/custom.css" rel="stylesheet">
        <link href="css/icheck/flat/green.css" rel="stylesheet">


        <script src="js/jquery.min.js"></script>
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>

        <!--[if lt IE 9]>
        <script src="../assets/js/ie8-responsive-file-warning.js"></script>
        <![endif]-->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>


    <body class="nav-md">

        <div class="container body">


            <div class="main_container">

                <div class="col-md-3 left_col">
                    <div class="left_col scroll-view">
                        <div class="profile">
                            <div class="profile_pic">
                                <a href="xaltindex.html" class="site_title"><img src="images/xalt-image.png" alt="..." class="img-thumbnail profile_img"></a>
                            </div>
                            <div class="clearfix"></div>
                        </div>

                        <!-- sidebar menu -->
                        <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">

                            <div class="menu_section">
                                <br />
                                <h3>General</h3>
                                <ul class="nav side-menu">
                                    <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu" style="display: none">
                                        <li><a href="xaltindex.html">Dashboard</a> </li>
                                        <li><a href="xalt_usage.html">Usage</a> </li>
                                        <li><a href="xalt_usp.html">User Provenance</a> </li>
                                        <li><a href="xalt_identify.html">Identify User</a> </li>
                                        <li><a href="xalt_usp_cscs.html">CSCS</a> </li>
                                    </ul>
                                    </li>
                                </ul>
                            </div>
                            <div class="menu_section">
                                <ul class="nav side-menu">
                                    <li><a><i class="fa fa-bug"></i> Additional Pages <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu" style="display: none">
                                        <li><a href="https://github.com/Fahey-McLay/xalt" target="_blank">Download from Github</a>
                                        </li>
                                        <li><a href="https://sourceforge.net/projects/xalt" target="_blank">Download from Sourceforge</a>
                                        </li>
                                    </ul>
                                    </li>
                                </ul>
                            </div>

                        </div>
                        <!-- /sidebar menu -->

                        <!-- /menu footer buttons -->
                        <div class="sidebar-footer hidden-small">
                            <a data-toggle="tooltip" data-placement="top" title="Settings">
                                <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
                            </a>
                            <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                                <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
                            </a>
                            <a data-toggle="tooltip" data-placement="top" title="Lock">
                                <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
                            </a>
                            <a data-toggle="tooltip" data-placement="top" title="Logout">
                                <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
                            </a>
                        </div>
                        <!-- /menu footer buttons -->
                    </div>
                </div>

                <!-- top navigation -->
                <div class="top_nav">

                    <div class="nav_menu">
                        <nav class="" role="navigation">
                        <div class="nav toggle">
                            <a id="menu_toggle"><i class="fa fa-bars"></i></a>
                        </div>
                        </nav>
                    </div>

                </div>
                <!-- /top navigation -->

                <!-- page content -->
                <div class="right_col" role="main">
                    <div class="">
                        <div class="page-title">
                            <div class="title_left">
                                <h3>User Provenance
                                    <small> Get run/link details for given user</small>
                                </h3>
                            </div>
                        </div>
                        <div class="clearfix"></div>

                        <div class="row">

                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <div class="dashboard_graph x_panel">
                                    <div class="x_title">
                                        <div class="clearfix"></div>
                                        <p align="justify"> Select syshost and date range for your queries and enter whole/part of UserID.</p>
                                    </div> <!-- x_title -->

                                    <form id="demo-form" class="form-inline" data-parsley-validate>
                                        <div class="form-group"> 
                                            <label class="pull-left" for="sysHost">Select Syshost<span class="required">*</span>
                                                <select id="select-sysHost" 
                                                    style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc"> </select>
                                            </label>
                                        </div> 
                                        <div class="form-group">
                                            <label id="reportrange" class="pull-left" 
                                                style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
                                                <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>

                                                <span>December 30, 2014 - January 28, 2015</span> <b class="caret"></b>
                                            </label>
                                        </div></br>
                                        <div class="form-group">
                                            <label class="pull-left" for="userId">Enter User ID <span class="required">* </span>
                                            <input type="text" id="userId" required="required" placeholder="Whole ID or part of it"
                                                style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
                                            </input>
                                            </label>
                                        </div> </br> 
                                        <div class="form-group">
                                            <span class="btn btn-default btn-xs" id="startBtn">Submit</span>
                                        </div>
                                    </form>
                                </div> <!-- x_panel -->

                            </div> <!-- col-md -->
                        </div> <!-- row -->

                        <div class="row">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <div class="dashboard_graph x_panel">
                                    <div class="row x_title">
                                        <div class="col-md-20">
                                            <h2>Further Details </h2>
                                            <ul class="nav navbar-right panel_toolbox">
                                                <li><a class="collapse-link"><i class="fa fa-chevron-down"></i></a></li>
                                            </ul>
                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                    <div class="x_content">
                                        <div class="row">

            <div class="col-xs-12">

  <!-- ................. usp_cscs.js:usp|uspCSCSUserList.php -->
                <label id="cscsUid0" style="visibility: hidden;">User details<small> (CSCS DB) </small> </label>
                <div id="usp_cscsuid0_div" style="visibility: hidden;"></div>

  <!-- ................. usp_cscs.js:usp|cscs_projectpi.php -->
                <label id="cscsPI" style="visibility: hidden;">User PI<small> (CSCS DB) </small> </label>
                <div id="usp_cscsprojectpi_div" style="visibility: hidden;"></div>

  <!-- ................. usp_cscs.js:usp|cscs_sbucheck.php -->
                <label id="cscsSbucheck" style="visibility: hidden;">Usage details<small> (CSCS DB) </small> </label>
                <div id="usp_cscssbucheck_div" style="visibility: hidden;"></div>

  <!-- ................. usp_cscs.js:usp|uspExecList.php -->
                <label id="lblExec0" style="visibility: hidden;">List of Executables<small> (having JobRunID) </small> </label>
                <div id="usp_exec_div" style="visibility: hidden;"></div>
                <label id="lblExec1" style="visibility: hidden;"> <small>[Count = Number of times executable was run]</small> </label>

            </div>

            <div class="col-xs-12">
                </br>

  <!-- ................. usp_cscs.js:gTu0|uspExecDetail.php -->
                <label id="lblExecDetail0" style="visibility: hidden;">Executable Details </label>
                <div id="usp_exDetail_div" style="visibility: hidden;"></div> <!-- Exec Detail table chart -->
            </div> 
            <div class="col-xs-10">
                </br>

  <!-- ................. -->
                <label id="lblObj" style="visibility: hidden">Objects Linked 
                    <small>(to the given Executable)</small>
                </label>
                <div id="obj_div" style="visibility: hidden;"></div> <!-- Object table -->
            </div>

            <div class="col-xs-2">
                </br>

  <!-- ................. -->
                <label id="lblFunc" style="visibility: hidden">Functions Called 
                </label>
                <div id="func_div" style="visibility: hidden;"></div> <!-- Function table -->
            </div>

            <div class="col-xs-12">
                </br>

  <!-- ................. -->
                <label id="lblUspRun0" style="visibility: hidden">Job Run details 
                    <small>(for given RunUser-UUID )</small>
                </label>
                <div id="usp_run_div" style="visibility: hidden;"></div> <!-- Job Run table chart -->

  <!-- ................. -->
                <label id="lblUspRun1" style="visibility: hidden;"> 
                    <small>(*nC-nJC-nN-nT ~ #Cores-#JobNumCores-#Nodes-#Threads) usp.js:gTu1 uspJobDetail.php</small>
                </label>
            </div>

            <div class="col-xs-12">
                </br>

  <!-- ................. -->
                <label id="lblRunEnv" style="visibility: hidden">Run Environment Details 
                    <small>(for the given Job)</small>
                </label>
                <div id="run_env_div" style="visibility: hidden;"></div> <!-- Job Run table chart -->
            </div>

            <div class="col-xs-12">
                </br>

  <!-- ................. -->
                <label id="lblRunObj" style="visibility: hidden">Objects Linked at Runtime
                    <small>(to the given executable)</small>
                </label>
                <div id="runObj_div" style="visibility: hidden;"></div> <!-- Object at runtime chart -->
            </div>

        </div>

    </div>
</div>

                            </div>  <!-- col-md -->
                        </div> <!-- row -->

                        <div id="spinner" style="display: none;" alt="loading..."/>
                        </div>
                    </div>

                    <!-- footer content -->
                    <footer>
                    <div class="">
                        <p class="pull-right"><a></a> |
                        <span class="lead"> <i class="fa fa-paw"></i> XALT!</span>
                        </p>
                    </div>
                    <div class="clearfix"></div>
                    </footer>
                    <!-- /footer content -->

                </div>
                <!-- /page content -->
            </div>

        </div>

        <div id="custom_notifications" class="custom-notifications dsp_none">
            <ul class="list-unstyled notifications clearfix" data-tabbed_notifications="notif-group">
            </ul>
            <div class="clearfix"></div>
            <div id="notif-group" class="tabbed_notifications"></div>
        </div>

        <script src="js/bootstrap.min.js"></script>

        <!-- chart js -->
        <script src="js/chartjs/chart.min.js"></script>
        <!-- bootstrap progress js -->
        <script src="js/progressbar/bootstrap-progressbar.min.js"></script>
        <script src="js/nicescroll/jquery.nicescroll.min.js"></script>
        <!-- daterangepicker -->
        <script type="text/javascript" src="js/moment.min2.js"></script>
        <script type="text/javascript" src="js/datepicker/daterangepicker.js"></script>
        <!-- icheck -->
        <script src="js/icheck/icheck.min.js"></script>

        <script src="js/custom.js"></script>

        <!-- moris js
        <script src="js/moris/raphael-min.js"></script>
        <script src="js/moris/morris.js"></script>
        <script src="js/moris/example.js"></script>
        -->

        <!-- google/chart -->
        <script type="text/javascript" src="js/google/usp_cscs.js"></script>

        <!-- form validation STARTs-->
        <script type="text/javascript" src="js/parsley/parsley.min.js"></script>

        <!-- startBtn and Validate Form -->
        <script>
            var userId;

            $(document).ready(function () {
                $.listen('parsley:field:validate', function () {
                    validateFront();
                });
                $('#demo-form .btn').on('click', function () {
                    $('#demo-form').parsley().validate();
                    validateFront();
                });
                var validateFront = function () {
                    if (true === $('#demo-form').parsley().isValid()) {
                        $('.bs-callout-info').removeClass('hidden');
                        $('.bs-callout-warning').addClass('hidden');
                        } else {
                        $('.bs-callout-info').addClass('hidden');
                        $('.bs-callout-warning').removeClass('hidden');
                    }
                };  
                $('#startBtn').on('click', function () {
                    if (true === $('#demo-form').parsley().isValid()) {
                        $('#spinner').show();
                        userId = document.getElementById("userId").value; 
                        usp(sysHost, startDate, endDate, userId);
                    }

                }); 

            });
            try {
                hljs.initHighlightingOnLoad();
            } catch (err) {} 
        </script>
        <!-- startBtn and form validation  ENDs-->
        <!-- form validation  ENDs-->

        <!-- Include syshost Start++ -->
        <script>
            var sysHost;
            $(document).ready(function () {
                var request = $.ajax
                ({url: "include/syshost.php",type: "POST",
                    dataType: "html"});

                request.done(function(data){
                    $("#select-sysHost").html(data);
                    sysHost = document.getElementById("select-sysHost").value;
                });
                $('#select-sysHost').change(function() {
                    sysHost = document.getElementById("select-sysHost").value;
                    console.log("Syshost Selected:  " + sysHost);
                });
            });

        </script>
        <!-- Include syshost Ends -->
        <!-- loading spinner starts -->
        <script type="text/javascript">
            var t;
            $(document).ajaxStart(function() {
                    $('#spinner').show();
                    });
            $(document).ajaxStop(function() {
                    setTimeout("$('#spinner').hide()", 1000);
                    });
        </script>
        <!-- loading spinner ends -->

        <!-- datepicker -->
        <script type="text/javascript">

            var startDate;
            var endDate;

            $(document).ready(function () {

                    var cb = function (start, end, label) {
                    console.log(start.toISOString(), end.toISOString(), label);
                    $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
                    }

                    var optionSet1 = {startDate: moment().subtract(29, 'days'),
                    //cscs var optionSet1 = {startDate: moment().subtract(1, 'days'),
                    endDate: moment(),
                    minDate: '01/11/2014',
                    maxDate: moment(),
                    dateLimit: {days: 365},
                    showDropdowns: true,showWeekNumbers: true,timePicker: false,timePickerIncrement: 1,timePicker12Hour: true,ranges: 
                    {'This Year': [moment().startOf('year'), moment().endOf('month')],
                    'Last Year': [moment().subtract(1, 'year').startOf('year'), moment().subtract(1, 'year').endOf('year')],
                    'Today': [moment(), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Day-1': [moment().subtract(1, 'days'), moment()],
                    'Day-2': [moment().subtract(2, 'days'), moment()],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                    },opens: 'left',buttonClasses: ['btn btn-default'],applyClass: 'btn-small btn-primary',
                    cancelClass: 'btn-small',format: 'MM/DD/YYYY',separator: ' to ',locale: {applyLabel: 'Submit',cancelLabel: 'Clear',
                    fromLabel: 'From',
                    toLabel: 'To',
                    customRangeLabel: 'Custom',
                    daysOfWeek: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
                    monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                    firstDay: 1
                }
                    };

                    //cscs $('#reportrange span').html(moment().subtract(1, 'days').format('MMMM D, YYYY') + ' - ' + moment().format('MMMM D, YYYY'));
                    $('#reportrange span').html(moment().subtract(29, 'days').format('MMMM D, YYYY') + ' - ' + moment().format('MMMM D, YYYY'));

                    $('#reportrange').daterangepicker(optionSet1, cb);

                    startDate = moment().subtract(29, 'days').format('YYYY-MM-DD');
                    endDate = moment().format('YYYY-MM-DD'); 
                    $('#reportrange').on('show.daterangepicker', function () {
                            console.log("xalt_usp.html: show event fired");
                            });
                    $('#reportrange').on('hide.daterangepicker', function () {
                            console.log("xalt_usp.html: hide event fired");
                            });
                    $('#reportrange').on('apply.daterangepicker', function (ev, picker) {
                            startDate = picker.startDate.format('YYYY-MM-DD');
                            endDate = picker.endDate.format('YYYY-MM-DD');
                            sysHost = document.getElementById("select-sysHost").value;

                            console.log("apply event fired, start/end dates are " + picker.startDate.format('MMMM D, YYYY') + " to " + picker.endDate.format('MMMM D, YYYY') + " to Syshost " + sysHost );
                            });
                    $('#reportrange').on('cancel.daterangepicker', function (ev, picker) {
                            console.log("cancel event fired");
                            });
                    $('#options1').click(function () {
                            $('#reportrange').data('daterangepicker').setOptions(optionSet1, cb);
                            });
                    $('#options2').click(function () {
                            $('#reportrange').data('daterangepicker').setOptions(optionSet2, cb);
                            });
                    $('#destroy').click(function () {
                            $('#reportrange').data('daterangepicker').remove();
                            });
                    $('#startBtn').on('click', function () {
                            console.log("start/end dates are " + startDate + " to " + endDate + " to Syshost " + sysHost );
                            });
            });
        </script>
        <!-- /datepicker -->

    </body>


</html>
